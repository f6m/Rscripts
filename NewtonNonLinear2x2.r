library(pracma)
library(rootSolve)

#Sistema no lineal 2x2
B <-1.05 #Entrada
f1 <- function(x,y) (x^{-B/2}-y^{-B/2}-1)
f2 <- function(x,y) (-x^{1-(B/2)}+y^{1-(B/2)}-(2/B)+1)

#Valores iniciales (x0,y0)
x = 0.01
y = 0.03

X0 <- matrix(data=c(x,y), nrow=2, ncol=1, byrow=TRUE)
print(X0)
d<-1.0 #distancia entre los vectores de la sucecioin
while(d>0.001){
#Jacobiano
J <- matrix(data=c(-(B/2)/x^{(B/2)+1}, (B/2)/y^{(B/2)+1},
                   ((B/2)-1)/x^{B/2}, (1-(B/2))/y^{B/2}), nrow=2, ncol=2, byrow=TRUE)

F <- matrix(data=c(f1(x,y), f2(x,y)), nrow=2, ncol=1, byrow=TRUE)
w = X0 + round(solve(J,-1*F),4)
d = sqrt((x-w[1])^2+(y-w[2])^2)
X0 = w
print(w)
print(d)
}

B=0.05
model <- function(x) c(F1 = x[1]^{-B/2}-x[2]^{-B/2}-1, 
                       F2 = -x[1]^{1-(B/2)}+x[2]^{1-(B/2)}-(2/B)+1)
(ss <- multiroot(f = model, start = c(1.5, 0.5)))

x=0.4014164
y=2.5260539 
f1(x,y)
f2(x,y)
B

#(B=0.05, x=0.09735982,y=5.23829755) (F1=1.659597e-10, F2=9.901413e-12)

#Punto inicial c=(0.1,1)
#(B=0.45, x=0.09735982,y=5.23829755) (F1=1.659597e-10, F2=9.901413e-12)
#(B=0.5, x=0.1262012,y=4.7386362) (F1=3.336464e-11, F2=2.421174e-12)
#(B=0.55, x=0.1555672,y=4.3344671) (F1=4.996599e-10, F2=4.189316e-11)
#(B=0.6, x=0.184761,y=4.002071) (F1=1.674470e-08, F2=1.515142e-09)
#(B=0.65, x=0.2133165,y=3.7247852) (F1=1.730665e-10, F2=1.466383e-11)
#(B=0.7, x=0.2409385,y=3.4905914) (F1=4.221290e-12, F2=-2.515099e-12)
#(B=0.75, x=0.2674539,y=3.2906274) (F1=6.795837e-08, F2=6.841636e-09)
#(B=0.8, x=0.2927743,y=3.1182337) (F1=5.075496e-12, F2=5.566658e-13)
#(B=0.85, x=0.316868,y=2.968321) (F1=2.899043e-10, F2=3.150546e-11)
#(B=0.9, x=0.3397417,y=2.8369449) (F1=4.876737e-09, F2=5.236840e-10)
#(B=0.95, x=0.3614258,y=2.7210040) (F1=4.118523e-08, F2=4.320301e-09)
#(B=1.0, x=0.3819659,y=2.6180338) (F1=2.236124e-07, F2=2.268893e-08)
#(B=1.05, x=0.4014164,y=2.5260539)
#(B=1.1, x=0.4198352,y=2.4434559) (F1=9.072076e-12, F2=8.572032e-13)
#(B=1.15, x=0.437282,y=2.368923) (F1=6.584866e-11, F2=5.766387e-12)
#(B=1.2, x=0.4538157,y=2.3013675) (F1=3.668275e-10, F2=3.058609e-11)
#(B=1.25, x=0.4694935,y=2.2398843) (F1=1.651360e-09, F2=1.277189e-10)
#(B=1.3, x=0.484370,y=2.183715) (F1=6.265608e-09, F2=14.469114e-10)
#(B=1.35, x=0.498497,y=2.132218) (F1=2.056350e-08, F2=1.337541e-09)
#(B=1.4, x=0.5119231,y=2.0848507) (F1=5.967087e-08, F2=3.504697e-09)
#(B=1.45, x=0.5246937,y=2.0411486) (F1=1.557035e-07, F2=8.158126e-09)
#(B=1.5, x=0.5368512,y=2.0007130) (F1=3.700032e-07, F2=1.703993e-08)
#(B=1.55, x=0.5484355,y=1.9632007) (F1=6.921130e-13, F2=2.631229e-14)
#(B=1.6, x=0.5594826,y=1.9283124) (F1=2.716272e-12, F2=8.948398e-14)
#(B=1.65, x=0.5700267,y=1.8957887) (F1=9.815704e-12, F2=2.956524e-13)
#(B=1.7, x=0.5800991,y=1.8654024) (F1=3.028111e-11, F2=7.432943e-13)
#(B=1.75, x=0.5897291,y=1.8369540) (F1=8.081402e-11, F2=1.554867e-12)
#(B=1.8, x=0.5989436,y=1.8102678) (F1=1.862679e-10, F2=2.443157e-12)
#(B=1.85, x=0.6077677,y=1.7851881) (F1=3.579137e-10, F2=3.100409e-12)
#(B=1.9, x=0.6162244,y=1.7615770) (F1=5.438672e-10, F2=2.310485e-12)
#(B=1.95, x=0.6243354,y=1.7393115) (F1=5.798784e-10, F2=5.069278e-13)
#(B=2.0, x=0.6243354,y=1.7393115) (F1=5.798784e-10, F2=5.069278e-13)


